# Авторизация

Нужно написать маленькое приложение с авторизацией на сессиях, шифрованием паролей и защищённым роутом.

## Подготовка

Установи все пакеты, подключи БД, запусти миграцию, создай тестового пользователя с помощью seeder-файла.

Запусти приложение. Проверь, что сейчас доступно в UI через браузер. Познакомься с кодом проекта и посмотри, какие файлы отвечают за ту или иную страницу.

Существующие файлы и роуты можно и нужно менять. Также их можно удалять, если посчитаешь, что они не нужны.

## 1. Вход (login)

Сделай так, чтобы можно было войти в приложение через учётную запись тестового пользователя (userName: `test`, password: `test`).

Для этого поработай с библиотеками [express-session](https://www.npmjs.com/package/express-session) и [bcrypt](https://www.npmjs.com/package/bcrypt).

Хранишь сессии с помощью [session-file-store](https://www.npmjs.com/package/session-file-store)? Позаботься о корректной обработке папки `sessions`:

- Игнорируй папку `sessions` в Git — эти файлы будут генерироваться пользователем.
- Игнорируй папку `sessions` при запуске через [nodemon](https://www.npmjs.com/package/nodemon#ignoring-files) — чтобы сервер не перезапускался каждый раз при входе в приложение.

Сделай не менее 1 коммита для этого функционала.

## 2. Выход (logout)

Сделай так, чтобы из приложения можно было выйти. После выхода сессия на сервере должна быть удалена, а cookie на клиенте — очищена.

Сделай не менее 1 коммита для этого функционала.

## 3. Профиль (profile)

Сделай так, чтобы пользователь мог посмотреть свои данные.

Сделай не менее 1 коммита для этого функционала.

## 4. Защита роутов

Сделай middleware для защиты роута от неавторизованных посетителей. Неавторизованных посетителей нужно перенаправлять на страницу входа.

Защити с помощью этого middleware страницу профиля.

Сделай не менее 1 коммита для этого функционала.

## 5. Пользователь в res.locals

Сделай middleware для получения данных пользователя на основе информации в `req.session` и записи этих данных в `res.locals.user`.

Подключи этот middleware к любому роуту, который рендерит HTML-страницу, и проследи, как данные из БД попадают на HTML-страницы с помощью `res.locals`.

Сделай не менее 1 коммита для этого функционала.

## 6. Регистрация (register)

Сделай так, чтобы посетитель мог зарегистрировать нового пользователя.

Добавь валидацию на бэкенде — например, проверяй `userName` на уникальность, задай минимальную длину пароля.

Хэшируй пароли с помощью [bcrypt](https://www.npmjs.com/package/bcrypt).

Сделай не менее 1 коммита для этого функционала.

## Всё готово?

- Поймай и обработай всевозможные ошибки через try/catch. Собери их все! :D
- Обработай больше сценариев без перезагрузки страницы.
- Добавь валидацию на фронтенде.
